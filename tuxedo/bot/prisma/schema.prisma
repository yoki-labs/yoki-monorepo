generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Server {
    id          Int          @id @default(autoincrement())
    serverId    String       @unique @db.VarChar(255)
    botJoinedAt DateTime?    @default(now())
    premium     PremiumType?
    locale      String       @default("en-US")
    prefix      String?
    blacklisted Boolean      @default(false)
}

model Giveaway {
    // Basics
    id           String   @id @db.VarChar(255)
    serverId     String   @db.VarChar(255)
    channelId    String   @db.VarChar(255)
    messageId    String   @db.VarChar(255)
    // Rewards, rewardees, etc.
    text         String   @db.VarChar(200)
    // Who, when
    participants String[]
    winnerCount  Int
    endsAt       DateTime
    createdBy    String   @db.VarChar(255)
    createdAt    DateTime @default(now())
}

model Currency {
    // Basics
    id              String @id @db.VarChar(255)
    serverId        String @db.VarChar(255)
    name            String @db.VarChar(100)
    tag             String @db.VarChar(16)
    // Perks
    startingBalance Int?
    maximumBalance  Int?
}

model ServerMember {
    // Basics
    id       String @id @db.VarChar(255)
    serverId String @db.VarChar(255)
    userId   String @db.VarChar(255)
    // Inventory
    balance  Json   @db.JsonB
}

// Copied from Yoki
model Role {
    id        Int      @id @default(autoincrement())
    serverId  String   @db.VarChar(255)
    roleId    Int      @db.Integer
    createdAt DateTime @default(now())
    type      RoleType

    @@unique([serverId, roleId, type])
}

enum PremiumType {
    Gold
    Silver
    Copper
}

enum RoleType {
    MINIMOD
    MOD
    ADMIN
}
